<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pharmacy Tools - 藥師專業臨床工具庫</title>
    
    <!-- React and ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts: Noto Sans TC -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #f8fafc;
            /* 醫療科技感的方格背景 */
            background-image: radial-gradient(#cbd5e1 1px, transparent 1px);
            background-size: 24px 24px;
        }
        .glass-effect {
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(12px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.3);
        }
        .card-hover {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .card-hover:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 24px -8px rgba(13, 148, 136, 0.15), 0 4px 8px -4px rgba(0, 0, 0, 0.05);
            border-color: #99f6e4; /* teal-200 */
        }
        /* 裝飾性光暈 */
        .blob-bg {
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 100%;
            height: 600px;
            background: radial-gradient(circle at 50% 0%, rgba(45, 212, 191, 0.15) 0%, rgba(255, 255, 255, 0) 70%);
            z-index: -1;
            pointer-events: none;
        }
        /* 自定義滾動條 */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1; 
        }
        ::-webkit-scrollbar-thumb {
            background: #cbd5e1; 
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #94a3b8; 
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.95); }
            to { opacity: 1; transform: scale(1); }
        }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-4px); }
            20%, 40%, 60%, 80% { transform: translateX(4px); }
        }
        .shake-animation {
            animation: shake 0.4s ease-in-out;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // ==========================================
        // 內建圖示元件庫
        // ==========================================
        const IconBase = ({ children, size = 24, className = "" }) => (
            <svg 
                xmlns="http://www.w3.org/2000/svg" 
                width={size} 
                height={size} 
                viewBox="0 0 24 24" 
                fill="none" 
                stroke="currentColor" 
                strokeWidth="2" 
                strokeLinecap="round" 
                strokeLinejoin="round" 
                className={className}
            >
                {children}
            </svg>
        );

        const Icons = {
            Search: (props) => (
                <IconBase {...props}><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></IconBase>
            ),
            Pill: (props) => (
                <IconBase {...props}><path d="m10.5 20.5 10-10a4.95 4.95 0 1 0-7-7l-10 10a4.95 4.95 0 1 0 7 7Z"/><path d="m8.5 8.5 7 7"/></IconBase>
            ),
            Stethoscope: (props) => (
                <IconBase {...props}>
                    <path d="M4.8 2.3A.3.3 0 1 0 5 2H4a2 2 0 0 0-2 2v5a6 6 0 0 0 6 6v0a6 6 0 0 0 6-6V4a2 2 0 0 0-2-2h-1a.2.2 0 1 0 .3.3"/>
                    <path d="M8 15v1a6 6 0 0 0 6 6v0a6 6 0 0 0 6-6v-4"/>
                    <circle cx="20" cy="10" r="2"/>
                </IconBase>
            ),
            Calculator: (props) => (
                <IconBase {...props}><rect width="16" height="20" x="4" y="2" rx="2"/><line x1="8" x2="16" y1="6" y2="6"/><line x1="16" x2="16" y1="14" y2="18"/><path d="M16 10h.01"/><path d="M12 10h.01"/><path d="M8 10h.01"/><path d="M12 14h.01"/><path d="M8 14h.01"/><path d="M12 18h.01"/><path d="M8 18h.01"/></IconBase>
            ),
            BookOpen: (props) => (
                <IconBase {...props}><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></IconBase>
            ),
            Activity: (props) => (
                <IconBase {...props}><path d="M22 12h-4l-3 9L9 3l-3 9H2"/></IconBase>
            ),
            ExternalLink: (props) => (
                <IconBase {...props}><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" x2="21" y1="14" y2="3"/></IconBase>
            ),
            Github: (props) => (
                <IconBase {...props}><path d="M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4"/><path d="M9 18c-4.51 2-5-2-7-2"/></IconBase>
            ),
            Menu: (props) => (
                <IconBase {...props}><line x1="4" x2="20" y1="12" y2="12"/><line x1="4" x2="20" y1="6" y2="6"/><line x1="4" x2="20" y1="18" y2="18"/></IconBase>
            ),
            X: (props) => (
                <IconBase {...props}><path d="M18 6 6 18"/><path d="m6 6 12 12"/></IconBase>
            ),
            FlaskConical: (props) => (
                <IconBase {...props}><path d="M10 2v7.527a2 2 0 0 1-.211.896L4.72 20.55a1 1 0 0 0 .9 1.45h12.76a1 1 0 0 0 .9-1.45l-5.069-10.127A2 2 0 0 1 14 9.527V2"/><path d="M8.5 2h7"/><path d="M7 16h10"/></IconBase>
            ),
            HeartPulse: (props) => (
                <IconBase {...props}><path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"/><path d="M3.22 12H9.5l.5-1 2 4.5 2-7 1.5 3.5h5.27"/></IconBase>
            ),
            User: (props) => (
                <IconBase {...props}><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></IconBase>
            ),
            Info: (props) => (
                <IconBase {...props}><circle cx="12" cy="12" r="10"/><path d="M12 16v-4"/><path d="M12 8h.01"/></IconBase>
            ),
            Book: (props) => (
                <IconBase {...props}><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"/></IconBase>
            ),
            // 新增 Instagram 圖示
            Instagram: (props) => (
                <IconBase {...props}>
                    <rect width="20" height="20" x="2" y="2" rx="5" ry="5"/><path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"/><line x1="17.5" x2="17.51" y1="6.5" y2="6.5"/>
                </IconBase>
            ),
            // 新增 Globe (網頁) 圖示
            Globe: (props) => (
                <IconBase {...props}>
                    <circle cx="12" cy="12" r="10"/><line x1="2" x2="22" y1="12" y2="12"/><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/>
                </IconBase>
            ),
            Link: (props) => (
                <IconBase {...props}><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/></IconBase>
            ),
            Lock: (props) => (
                <IconBase {...props}>
                    <rect x="3" y="11" width="18" height="11" rx="2" ry="2" />
                    <path d="M7 11V7a5 5 0 0 1 10 0v4" />
                </IconBase>
            ),
            ChevronLeft: (props) => (
                <IconBase {...props}><polyline points="15 18 9 12 15 6" /></IconBase>
            ),
            ChevronRight: (props) => (
                <IconBase {...props}><polyline points="9 18 15 12 9 6" /></IconBase>
            ),
            // 新增 Flame (熱門) 圖示 - 更新為更明顯的火焰造型
            Flame: (props) => (
                <IconBase {...props}>
                    <path d="M12 2c0 4 3 6 3 9a3 3 0 0 1-6 0c0-3 3-5 3-9z" />
                    <path d="M12 14a2 2 0 1 0 0 4 2 2 0 0 0 0-4" fill="currentColor"/>
                    <path d="M8.5 8.5C7.5 10 7 12 7 14a5 5 0 0 0 10 0c0-2.5-1.5-4.5-3-6" />
                </IconBase>
            )
        };

        const { 
            Search, Stethoscope, Pill, BookOpen, Calculator, Activity, ExternalLink, Github, Menu, X, 
            FlaskConical, HeartPulse, User, Info, Book, Instagram, Globe, Link, Lock, ChevronLeft, ChevronRight, Flame
        } = Icons;

        // ==========================================
        // 資料設定區
        // ==========================================
        
        // --- 相關連結資料 (請在此編輯您的部落格與 IG) ---
        const socialLinksData = [
            {
                id: 'blog',
                title: '蝦仁藥師的部落格',
                url: 'https://vocus.cc/user/@pharmacy', // 請填入部落格網址
                icon: <Globe size={20} />,
                color: 'bg-blue-50 text-blue-600 border-blue-100 hover:border-blue-300'
            },
            {
                id: 'instagram',
                title: '蝦仁藥師的Instagram',
                url: 'https://www.instagram.com/pharmacy_shrimp/', // 請填入 IG 網址
                icon: <Instagram size={20} />,
                color: 'bg-pink-50 text-pink-600 border-pink-100 hover:border-pink-300'
            },
            {
                id: 'other',
                title: '蝦仁藥師的Threads',
                url: 'https://www.threads.com/@pharmacy_shrimp?hl=zh-tw', 
                icon: <Link size={20} />,
                color: 'bg-slate-50 text-slate-600 border-slate-100 hover:border-slate-300'
            }
        ];

        const categories = [
            { id: 'all', name: '全部工具', icon: <Pill size={18} /> },
            { id: 'clinical', name: '臨床計算', icon: <Calculator size={18} /> },
            { id: 'education', name: '衛教工具', icon: <BookOpen size={18} /> },
            { id: 'sup', name: '輔助管理', icon: <Activity size={18} /> },
            { id: 'information', name: '臨床資訊', icon: <FlaskConical size={18} /> },
            { id: 'else', name: '其他工具', icon: <Activity size={18} /> },
        ];

        const appsData = [
            {
                id: 1,
                title: "腎功能計算機",
                description: "根據年齡體重與腎功能相關指標，快速計算出腎功能估算值。",
                category: "clinical",
                url: "https://ad123654741-design.github.io/pharmacy-gemini-app-project/%E8%85%8E%E5%8A%9F%E8%83%BD%E8%A8%88%E7%AE%97%E6%A9%9F-%E8%9D%A6%E4%BB%81%E8%97%A5%E5%B8%AB.html", 
                tags: ["劑量", "腎功能"],
                color: "bg-blue-100 text-blue-600",
                isPopular: true // 設定為熱門
            },
            {
                id: 2,
                title: "鴉片類止痛藥物等效劑量轉換器",
                description: "快速換算各種常見之鴉片類止痛藥物劑量。",
                category: "clinical",
                url: "https://ad123654741-design.github.io/pharmacy-gemini-app-project/%E9%B4%89%E7%89%87%E9%A1%9E%E6%AD%A2%E7%97%9B%E8%97%A5%E7%89%A9%E7%AD%89%E6%95%88%E5%8A%91%E9%87%8F%E8%BD%89%E6%8F%9B%E5%99%A8.html",
                tags: ["嗎啡", "劑量轉換"],
                color: "bg-red-100 text-red-600"
            },
            {
                id: 3,
                title: "帕金森氏症藥物LED計算工具",
                description: "此工具用於計算常用帕金森氏症藥物的 Levodopa Equivalent Dose (LED)。",
                category: "clinical",
                url: "https://ad123654741-design.github.io/pharmacy-gemini-app-project/Parkinson.html.html",
                tags: ["帕金森氏症", "劑量轉換"],
                color: "bg-green-100 text-green-600"
            },
            {
                id: 4,
                title: "Naranjo Score ADR評估工具",
                description: "評估藥物不良反應 (ADR) 與藥物之關聯性。",
                category: "clinical",
                url: "https://ad123654741-design.github.io/pharmacy-gemini-app-project/ADR.html",
                tags: ["ADR", "藥物不良反應"],
                color: "bg-orange-100 text-orange-600"
            },
            {
                id: 5,
                title: "CKD預後風險 智能評估系統",
                description: "整合eGFR與UACR數據，即時生成KDIGO腎功能分級與臨床追蹤建議。",
                category: "education",
                url: "https://ad123654741-design.github.io/pharmacy-gemini-app-project/CKD%E5%88%86%E6%9C%9F.html",
                tags: ["CKD", "腎功能"],
                color: "bg-purple-100 text-purple-600"
            },
            {
                id: 6,
                title: "護理臨床計算工作站",
                description: "整合護理臨床常用計算工具，涵蓋流速計算、檢驗數值校正、預產期估算等功能。",
                category: "clinical",
                url: "https://ad123654741-design.github.io/pharmacy-gemini-app-project/%E8%AD%B7%E7%90%86%E8%87%A8%E5%BA%8A%E8%A8%88%E7%AE%97%E5%B7%A5%E4%BD%9C%E7%AB%99.html",
                tags: ["滴速", "輸液", "EDD", "MAP"],
                color: "bg-teal-100 text-teal-600",
                isPopular: true // 設定為熱門
            },
            {
                id: 7,
                title: "印章模擬器",
                description: "將您上傳的圖像，轉化成不同色彩深淺的印章圖檔。",
                category: "else",
                url: "https://ad123654741-design.github.io/pharmacy-gemini-app-project/%E6%96%87%E9%9D%92%E7%89%88%E5%8D%B0%E7%AB%A0%E6%A8%A1%E6%93%AC%E5%99%A8.html", 
                tags: ["電子章", "文書處理"],
                color: "bg-blue-100 text-blue-600"
            },
            {
                id: 8,
                title: "互動式圖示元件庫",
                description: "可即時預覽並調整圖示大小顏色，直接應用於網頁製作。",
                category: "else",
                url: "https://ad123654741-design.github.io/pharmacy-gemini-app-project/%E4%BA%92%E5%8B%95%E5%BC%8F%E5%9C%96%E7%A4%BA%E5%85%83%E4%BB%B6%E5%BA%AB.html",
                tags: ["圖示元件", "網頁製作", "程式碼"],
                color: "bg-teal-100 text-teal-600"
            },
            {
                id: 9,
                title: "【藥學筆記】壯陽藥-PDE5抑制劑",
                description: "整理常見的PDE5抑制劑，並提供詳細臨床資料比較。",
                category: "information",
                url: "https://ad123654741-design.github.io/pharmacy-gemini-app-project/%E8%97%A5%E7%89%A9%E6%AF%94%E8%BC%83%20PDE5%E6%8A%91%E5%88%B6%E5%8A%91-%E5%A3%AF%E9%99%BD%E8%97%A5%E7%89%A9.html",
                tags: ["威而鋼", "樂威壯", "犀利士", "ED", "性功能"],
                color: "bg-red-100 text-red-600"
            },
            {
                id: 10,
                title: "【TDM】Vancomycin測試版",
                description: "依照臨床個案之生理參數，預測Vancomycin在體內的血中濃度變化。",
                category: "clinical",
                url: "https://ad123654741-design.github.io/pharmacy-gemini-app-project/Vancomycin%20TDM.html",
                tags: ["藥物血中濃度監測", "萬古黴素"],
                color: "bg-orange-100 text-orange-600"
            },
            {
                id: 11,
                title: "【藥學筆記】Statin臨床決策助手",
                description: "依照臨床實證指引，彙整了Statin的相關資訊，方便快速了解藥物之間的差異與注意事項。",
                category: "information",
                url: "https://ad123654741-design.github.io/pharmacy-gemini-app-project/Statin%20%E8%87%A8%E5%BA%8A%E6%B1%BA%E7%AD%96%E5%8A%A9%E6%89%8B.html",
                tags: ["降血脂", "血脂治療"],
                color: "bg-orange-100 text-orange-600",
                isPopular: true // 設定為熱門
            },
             {
                id: 12,
                title: "【藥學筆記】事後避孕藥臨床決策助手",
                description: "依照臨床實證指引，彙整了事後避孕藥的相關資訊，方便快速了解藥物之間的差異與注意事項。",
                category: "information",
                url: "https://ad123654741-design.github.io/pharmacy-gemini-app-project/Statin%20%E8%87%A8%E5%BA%8A%E6%B1%BA%E7%AD%96%E5%8A%A9%E6%89%8B.html",
                tags: ["UPA", "LNG", "Cu-IUD", "Yuzpe"],
                color: "bg-orange-100 text-orange-600",
                isPopular: true // 設定為熱門
            }
        ];

        // ==========================================
        // UI 元件
        // ==========================================

        const LoginScreen = ({ onLogin }) => {
            const [password, setPassword] = useState("");
            const [error, setError] = useState("");
            const [shake, setShake] = useState(false);

            const handleSubmit = (e) => {
                e.preventDefault();
                if (password === "789") {
                    onLogin();
                } else {
                    setError("密碼錯誤，請重新輸入");
                    setShake(true);
                    setPassword("");
                    setTimeout(() => setShake(false), 400); // 重置動畫狀態
                }
            };

            return (
                <div className="fixed inset-0 z-[100] flex items-center justify-center p-4 bg-slate-900/60 backdrop-blur-md">
                    <div className={`bg-white rounded-2xl shadow-2xl p-8 max-w-sm w-full border border-white/50 relative overflow-hidden ${shake ? 'shake-animation' : ''}`}>
                        
                        {/* 頂部裝飾 */}
                        <div className="absolute top-0 left-0 w-full h-1.5 bg-gradient-to-r from-teal-400 to-blue-500"></div>

                        <div className="flex flex-col items-center mb-8">
                            <div className="bg-teal-100 p-4 rounded-full text-teal-600 mb-4 shadow-inner">
                                <Lock size={32} />
                            </div>
                            <h2 className="text-2xl font-bold text-slate-800">請輸入6位數密碼</h2>
                            <p className="text-sm text-slate-500 mt-2 text-center">
                                本網站僅供醫事人員內部使用<br/>請輸入授權碼以繼續
                            </p>
                        </div>

                        <form onSubmit={handleSubmit} className="space-y-5">
                            <div>
                                <input
                                    type="password"
                                    className="block w-full px-4 py-3 rounded-xl border border-slate-200 bg-slate-50 focus:bg-white text-center text-lg tracking-widest focus:ring-2 focus:ring-teal-500 focus:border-transparent outline-none transition-all placeholder:text-slate-400 placeholder:tracking-normal placeholder:text-base"
                                    placeholder="輸入密碼"
                                    value={password}
                                    onChange={(e) => {
                                        setPassword(e.target.value);
                                        if(error) setError("");
                                    }}
                                    autoFocus
                                />
                                {error && (
                                    <p className="text-red-500 text-sm text-center mt-2 flex items-center justify-center gap-1 animate-[fadeIn_0.2s]">
                                        <X size={14} /> {error}
                                    </p>
                                )}
                            </div>
                            <button 
                                type="submit"
                                className="w-full bg-slate-800 hover:bg-teal-600 text-white py-3 rounded-xl font-medium transition-colors shadow-lg shadow-slate-200 hover:shadow-teal-100 flex items-center justify-center gap-2"
                            >
                                進入網站 <ExternalLink size={16} />
                            </button>
                        </form>
                    </div>
                </div>
            );
        };

        const Modal = ({ isOpen, onClose, title, children }) => {
            if (!isOpen) return null;
            return (
                <div className="fixed inset-0 z-[60] flex items-center justify-center p-4">
                    <div className="absolute inset-0 bg-slate-900/60 backdrop-blur-sm transition-opacity" onClick={onClose}></div>
                    <div className="relative bg-white/95 backdrop-blur rounded-2xl shadow-2xl w-full max-w-lg max-h-[90vh] overflow-y-auto animate-[fadeIn_0.25s_ease-out] border border-white/50">
                        <div className="sticky top-0 bg-white/90 backdrop-blur border-b border-slate-100 p-4 flex justify-between items-center z-10">
                            <h3 className="text-xl font-bold text-slate-800 flex items-center gap-2">
                                {title}
                            </h3>
                            <button onClick={onClose} className="p-2 hover:bg-slate-100 rounded-full transition-colors text-slate-500 hover:text-slate-800">
                                <X size={20} />
                            </button>
                        </div>
                        <div className="p-6">
                            {children}
                        </div>
                    </div>
                </div>
            );
        };

        const AppCard = ({ app }) => (
            <div className={`group bg-white rounded-2xl border p-6 card-hover flex flex-col justify-between h-full relative overflow-hidden ${app.isPopular ? 'border-orange-200 ring-1 ring-orange-100' : 'border-slate-200'}`}>
                {/* 裝飾性背景圓 */}
                <div className="absolute -right-4 -top-4 w-24 h-24 bg-gradient-to-br from-slate-50 to-slate-100 rounded-full z-0 group-hover:scale-110 transition-transform duration-500"></div>
                
                <div className="relative z-10">
                    <div className="flex justify-between items-start mb-4">
                        <div className={`p-3.5 rounded-xl ${app.color} shadow-sm`}>
                            <Pill size={24} />
                        </div>
                        
                        {/* 調整後的佈局：將 HOT 標籤和分類標籤並排顯示 */}
                        <div className="flex items-center gap-2">
                            {app.isPopular && (
                                <span className="bg-orange-500 text-white text-[10px] font-bold px-2 py-1 rounded-full flex items-center gap-1 shadow-md animate-pulse">
                                    <Flame size={12} fill="currentColor" /> HOT
                                </span>
                            )}
                            <span className="text-xs font-semibold tracking-wide text-slate-500 bg-slate-50 border border-slate-100 px-2.5 py-1 rounded-full">
                                {categories.find(c => c.id === app.category)?.name || '工具'}
                            </span>
                        </div>
                    </div>
                    <h3 className="text-xl font-bold text-slate-800 mb-2 group-hover:text-teal-700 transition-colors">{app.title}</h3>
                    <p className="text-slate-600 text-sm leading-relaxed mb-4">
                        {app.description}
                    </p>
                    <div className="flex flex-wrap gap-2 mb-6">
                        {app.tags.map((tag, index) => (
                            <span key={index} className="text-xs font-medium bg-white text-slate-500 px-2.5 py-1 rounded-md border border-slate-200 shadow-sm">
                                #{tag}
                            </span>
                        ))}
                    </div>
                </div>
                <a 
                    href={app.url} 
                    target="_blank" 
                    rel="noopener noreferrer"
                    className="relative z-10 w-full mt-auto flex items-center justify-center gap-2 bg-slate-900 hover:bg-teal-600 text-white py-3 rounded-xl transition-all font-medium text-sm shadow-lg shadow-slate-200 hover:shadow-teal-200 transform active:scale-95"
                >
                    開啟工具 <ExternalLink size={16} />
                </a>
            </div>
        );

        // 每頁顯示 12 個
        const ITEMS_PER_PAGE = 12;

        const App = () => {
            const [isAuthenticated, setIsAuthenticated] = useState(false); // 新增驗證狀態
            const [searchTerm, setSearchTerm] = useState("");
            const [activeCategory, setActiveCategory] = useState("all");
            const [isMenuOpen, setIsMenuOpen] = useState(false);
            const [showAbout, setShowAbout] = useState(false);
            const [showGuide, setShowGuide] = useState(false);
            const [showLinks, setShowLinks] = useState(false);
            const [currentPage, setCurrentPage] = useState(1);

            // Reset to page 1 when filter changes
            // Moved UP before the conditional return
            useEffect(() => {
                setCurrentPage(1);
            }, [searchTerm, activeCategory]);

            // 如果未通過驗證，顯示登入畫面
            if (!isAuthenticated) {
                return (
                    <div className="min-h-screen flex flex-col relative overflow-hidden bg-[#f8fafc]">
                        <div className="blob-bg"></div>
                        {/* 讓背景稍微顯現但被蓋住 */}
                        <div style={{ backgroundImage: 'radial-gradient(#cbd5e1 1px, transparent 1px)', backgroundSize: '24px 24px', position: 'absolute', inset: 0, zIndex: -1 }}></div>
                        <LoginScreen onLogin={() => setIsAuthenticated(true)} />
                    </div>
                );
            }

            // 搜尋與篩選邏輯，並加入熱門置頂排序
            const filteredApps = appsData.filter(app => {
                const term = searchTerm.toLowerCase();
                const matchesTitle = app.title.toLowerCase().includes(term);
                const matchesDesc = app.description.toLowerCase().includes(term);
                // 新增：搜尋標籤
                const matchesTags = app.tags.some(tag => tag.toLowerCase().includes(term));
                
                const matchesCategory = activeCategory === 'all' || app.category === activeCategory;
                
                return (matchesTitle || matchesDesc || matchesTags) && matchesCategory;
            }).sort((a, b) => {
                // 熱門項目置頂 (true 的排在前面)
                // 如果 a 是熱門 (1) 且 b 不是 (0)， 0 - 1 = -1 (a 排在 b 前面)
                return (b.isPopular ? 1 : 0) - (a.isPopular ? 1 : 0);
            });

            // Pagination Logic
            const totalPages = Math.ceil(filteredApps.length / ITEMS_PER_PAGE);
            const currentApps = filteredApps.slice(
                (currentPage - 1) * ITEMS_PER_PAGE,
                currentPage * ITEMS_PER_PAGE
            );

            return (
                <div className="min-h-screen flex flex-col relative overflow-x-hidden animate-[fadeIn_0.5s_ease-out]">
                    {/* 背景光暈效果 */}
                    <div className="blob-bg"></div>

                    {/* Header */}
                    <header className="fixed w-full z-50 glass-effect">
                        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                            <div className="flex justify-between items-center h-16">
                                <div className="flex items-center gap-3 cursor-pointer group" onClick={() => window.scrollTo({top: 0, behavior: 'smooth'})}>
                                    <div className="bg-teal-500 group-hover:bg-teal-600 transition-colors p-2 rounded-xl text-white shadow-lg shadow-teal-200">
                                        <HeartPulse size={24} />
                                    </div>
                                    <div>
                                        <h1 className="text-xl font-bold text-slate-800 tracking-tight leading-none group-hover:text-teal-700 transition-colors">Pharmacy Tools</h1>
                                        <p className="text-[10px] text-teal-600 font-bold uppercase tracking-wider mt-0.5">Clinical & Digital</p>
                                    </div>
                                </div>

                                {/* Desktop Nav */}
                                <nav className="hidden md:flex items-center gap-1">
                                    <button onClick={() => setShowAbout(true)} className="px-4 py-2 text-sm font-medium text-slate-600 hover:text-teal-700 hover:bg-teal-50 rounded-lg transition-all">關於本站</button>
                                    <button onClick={() => setShowGuide(true)} className="px-4 py-2 text-sm font-medium text-slate-600 hover:text-teal-700 hover:bg-teal-50 rounded-lg transition-all">使用指南</button>
                                    <button onClick={() => setShowLinks(true)} className="px-4 py-2 text-sm font-medium text-slate-600 hover:text-teal-700 hover:bg-teal-50 rounded-lg transition-all">相關連結</button>
                                    <div className="w-px h-4 bg-slate-300 mx-2"></div>
                                    <a href="https://github.com" target="_blank" className="p-2 text-slate-400 hover:text-slate-800 hover:bg-slate-100 rounded-lg transition-all">
                                        <Github size={20} />
                                    </a>
                                </nav>

                                {/* Mobile Menu Button */}
                                <button 
                                    className="md:hidden p-2 text-slate-600 hover:bg-slate-100 rounded-lg"
                                    onClick={() => setIsMenuOpen(!isMenuOpen)}
                                >
                                    {isMenuOpen ? <X size={24} /> : <Menu size={24} />}
                                </button>
                            </div>
                        </div>

                        {/* Mobile Nav */}
                        {isMenuOpen && (
                            <div className="md:hidden bg-white border-t border-slate-100 shadow-xl">
                                <div className="px-4 pt-2 pb-4 space-y-1">
                                    <button onClick={() => {setShowAbout(true); setIsMenuOpen(false)}} className="block w-full text-left px-4 py-3 text-base font-medium text-slate-600 hover:bg-slate-50 rounded-lg">關於本站</button>
                                    <button onClick={() => {setShowGuide(true); setIsMenuOpen(false)}} className="block w-full text-left px-4 py-3 text-base font-medium text-slate-600 hover:bg-slate-50 rounded-lg">使用指南</button>
                                    <button onClick={() => {setShowLinks(true); setIsMenuOpen(false)}} className="block w-full text-left px-4 py-3 text-base font-medium text-slate-600 hover:bg-slate-50 rounded-lg">相關連結</button>
                                </div>
                            </div>
                        )}
                    </header>

                    {/* Modals */}
                    
                    {/* 關於本站 Modal */}
                    <Modal isOpen={showAbout} onClose={() => setShowAbout(false)} title="關於本站">
                        <div className="space-y-4 text-slate-600">
                            <div className="flex items-center gap-4 mb-6 p-5 bg-gradient-to-br from-teal-50 to-white rounded-2xl border border-teal-100 shadow-sm">
                                <div className="bg-white p-3 rounded-full shadow-md text-teal-600 ring-4 ring-teal-50">
                                    <User size={32} />
                                </div>
                                <div>
                                    <h4 className="font-bold text-lg text-slate-800">製作者：蝦仁藥師</h4>
                                    <p className="text-sm text-teal-600 font-medium">致力於藥學與科技的跨界整合</p>
                                </div>
                            </div>
                            <p className="leading-relaxed">
                                Pharmacy Tools 是一個專為藥師與醫療人員設計的臨床工具入口網站。我們整合了各種臨床計算、衛教生成與行政輔助工具，旨在簡化繁瑣的日常作業，讓專業人員能將更多時間投入在病人照護上。
                            </p>
                            <div className="mt-6">
                                <h4 className="font-bold text-slate-800 mb-2 flex items-center gap-2">
                                    <Info size={18} className="text-amber-500"/> 免責聲明
                                </h4>
                                <div className="bg-slate-50 p-4 rounded-xl border border-slate-200 text-sm space-y-2">
                                    <p>• 本站所有工具僅供專業人員輔助參考。</p>
                                    <p>• 工具產出結果可能存在誤差，臨床決策請務必依據專業判斷。</p>
                                    <p>• 使用者應對工具產出結果進行最終確認。</p>
                                </div>
                            </div>
                        </div>
                    </Modal>

                    {/* 使用指南 Modal */}
                    <Modal isOpen={showGuide} onClose={() => setShowGuide(false)} title="使用指南">
                        <div className="space-y-8 text-slate-600 relative">
                            {/* 連接線 */}
                            <div className="absolute left-[19px] top-8 bottom-8 w-0.5 bg-slate-200"></div>
                            
                            <div className="relative flex gap-5">
                                <div className="flex-shrink-0 w-10 h-10 bg-white border-2 border-teal-500 text-teal-600 rounded-full flex items-center justify-center font-bold shadow-sm z-10">1</div>
                                <div className="pt-1">
                                    <h4 className="font-bold text-slate-800 text-lg">選擇類別</h4>
                                    <p className="text-sm mt-1 text-slate-500">透過上方的分類按鈕，快速篩選您需要的工具類型。</p>
                                </div>
                            </div>
                            <div className="relative flex gap-5">
                                <div className="flex-shrink-0 w-10 h-10 bg-white border-2 border-teal-500 text-teal-600 rounded-full flex items-center justify-center font-bold shadow-sm z-10">2</div>
                                <div className="pt-1">
                                    <h4 className="font-bold text-slate-800 text-lg">智能搜尋</h4>
                                    <p className="text-sm mt-1 text-slate-500">輸入藥名、適應症或「#標籤」，系統會即時顯示結果。</p>
                                </div>
                            </div>
                            <div className="relative flex gap-5">
                                <div className="flex-shrink-0 w-10 h-10 bg-teal-600 text-white rounded-full flex items-center justify-center font-bold shadow-md shadow-teal-200 z-10">3</div>
                                <div className="pt-1">
                                    <h4 className="font-bold text-slate-800 text-lg">開啟工具</h4>
                                    <p className="text-sm mt-1 text-slate-500">點擊卡片下方的黑色按鈕，將會在分頁開啟 AI 應用程式。</p>
                                </div>
                            </div>
                        </div>
                    </Modal>

                    {/* 相關連結 Modal */}
                    <Modal isOpen={showLinks} onClose={() => setShowLinks(false)} title="相關連結">
                        <div className="grid gap-3">
                            {socialLinksData.map(link => (
                                <a 
                                    key={link.id}
                                    href={link.url}
                                    target="_blank"
                                    rel="noopener noreferrer"
                                    className={`flex items-center gap-4 p-4 rounded-xl border transition-all hover:shadow-md ${link.color}`}
                                >
                                    <div className="p-2 bg-white rounded-full shadow-sm">
                                        {link.icon}
                                    </div>
                                    <span className="font-medium text-lg">{link.title}</span>
                                    <ExternalLink size={16} className="ml-auto opacity-50" />
                                </a>
                            ))}
                        </div>
                        <p className="text-center text-xs text-slate-400 mt-6">
                            歡迎追蹤我的社群，獲取最新藥學資訊
                        </p>
                    </Modal>

                    {/* Hero Section */}
                    <div className="pt-32 pb-16 px-4 sm:px-6 lg:px-8 relative">
                        <div className="max-w-4xl mx-auto text-center relative z-10">
                            
                            {/* 製作者資訊 Pill */}
                            <div className="flex justify-center mb-8 animate-[fadeIn_0.5s_ease-out]">
                                <div className="inline-flex items-center gap-3 bg-white/80 backdrop-blur pl-2 pr-4 py-1.5 rounded-full shadow-sm border border-slate-200/60 ring-1 ring-slate-100">
                                    <div className="relative">
                                        <span className="absolute inline-flex h-full w-full rounded-full bg-teal-400 opacity-75 animate-ping"></span>
                                        <span className="relative inline-flex rounded-full h-2.5 w-2.5 bg-teal-500"></span>
                                    </div>
                                    <span className="text-sm font-semibold text-slate-600 tracking-wide">製作者：蝦仁藥師</span>
                                </div>
                            </div>

                            <h2 className="text-4xl md:text-6xl font-extrabold text-slate-800 mb-6 leading-tight tracking-tight animate-[fadeIn_0.7s_ease-out]">
                                結合<span className="text-transparent bg-clip-text bg-gradient-to-r from-amber-400 to-orange-600 inline-block">藥學專業</span>與<span className="text-transparent bg-clip-text bg-gradient-to-r from-teal-500 to-blue-600 inline-block">數位科技</span><br/>
                                提升醫療照護品質
                            </h2>

                            <p className="text-lg md:text-xl text-slate-600 mb-10 max-w-2xl mx-auto leading-relaxed animate-[fadeIn_0.9s_ease-out]">
                                專為臨床藥師打造的專業輔助中心。<br className="hidden md:block"/>
                                快速進行劑量計算、交互作用判讀、衛教諮詢與行政管理。
                            </p>
                            
                            {/* Search Bar */}
                            <div className="relative max-w-xl mx-auto animate-[fadeIn_1.1s_ease-out]">
                                <div className="absolute inset-y-0 left-0 pl-5 flex items-center pointer-events-none text-slate-400">
                                    <Search size={22} />
                                </div>
                                <input
                                    type="text"
                                    className="block w-full pl-14 pr-6 py-5 rounded-2xl border-0 shadow-xl shadow-slate-200/60 ring-1 ring-slate-200 focus:ring-2 focus:ring-teal-500 text-lg text-slate-800 placeholder:text-slate-400 bg-white/90 backdrop-blur transition-all focus:bg-white focus:shadow-2xl focus:shadow-teal-100/50"
                                    placeholder="搜尋工具名稱、適應症或 #標籤..."
                                    value={searchTerm}
                                    onChange={(e) => setSearchTerm(e.target.value)}
                                />
                            </div>
                        </div>
                    </div>

                    {/* Main Content */}
                    <main className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pb-24 flex-grow w-full z-10">
                        
                        {/* Category Filter */}
                        <div className="flex flex-wrap justify-center gap-3 mb-12">
                            {categories.map(cat => (
                                <button
                                    key={cat.id}
                                    onClick={() => setActiveCategory(cat.id)}
                                    className={`
                                        flex items-center gap-2 px-5 py-2.5 rounded-xl text-sm font-medium transition-all duration-200
                                        ${activeCategory === cat.id 
                                            ? 'bg-slate-800 text-white shadow-lg shadow-slate-300 transform scale-105' 
                                            : 'bg-white text-slate-500 border border-slate-200 hover:bg-slate-50 hover:border-slate-300 hover:text-slate-700 shadow-sm'}
                                    `}
                                >
                                    {cat.icon}
                                    {cat.name}
                                </button>
                            ))}
                        </div>

                        {/* App Grid */}
                        {currentApps.length > 0 ? (
                            <>
                                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                                    {currentApps.map(app => (
                                        <AppCard key={app.id} app={app} />
                                    ))}
                                </div>
                                
                                {/* Pagination Controls */}
                                {totalPages > 1 && (
                                    <div className="flex justify-center items-center gap-4 mt-12">
                                        <button 
                                            onClick={() => setCurrentPage(Math.max(1, currentPage - 1))}
                                            disabled={currentPage === 1}
                                            className="p-2 rounded-lg border border-slate-200 text-slate-600 hover:bg-slate-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"
                                        >
                                            <ChevronLeft size={20} />
                                        </button>
                                        <span className="text-slate-600 font-medium">
                                            第 {currentPage} 頁，共 {totalPages} 頁
                                        </span>
                                        <button 
                                            onClick={() => setCurrentPage(Math.min(totalPages, currentPage + 1))}
                                            disabled={currentPage === totalPages}
                                            className="p-2 rounded-lg border border-slate-200 text-slate-600 hover:bg-slate-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"
                                        >
                                            <ChevronRight size={20} />
                                        </button>
                                    </div>
                                )}
                            </>
                        ) : (
                            <div className="text-center py-20 bg-white/50 backdrop-blur rounded-3xl border border-dashed border-slate-300">
                                <div className="inline-block p-6 rounded-full bg-slate-50 text-slate-300 mb-4">
                                    <Search size={48} />
                                </div>
                                <h3 className="text-xl font-medium text-slate-900 mb-2">找不到相關工具</h3>
                                <p className="text-slate-500">請嘗試使用不同的關鍵字或標籤進行搜尋。</p>
                            </div>
                        )}
                    </main>

                    {/* Footer */}
                    <footer className="bg-white border-t border-slate-200 pt-12 pb-8">
                        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                            <div className="flex flex-col md:flex-row justify-between items-center gap-6">
                                <div className="text-center md:text-left">
                                    <div className="flex items-center justify-center md:justify-start gap-2 mb-2 text-slate-800 font-bold">
                                        <HeartPulse size={20} className="text-teal-600"/>
                                        Pharmacy Tools
                                    </div>
                                    <p className="text-sm text-slate-500">
                                        &copy; {new Date().getFullYear()} Created by 蝦仁藥師.
                                    </p>
                                </div>
                                
                                <p className="text-xs text-slate-400 bg-slate-50 px-4 py-2 rounded-lg border border-slate-100 text-center max-w-md">
                                    免責聲明：本網站工具僅供專業輔助參考，計算結果與臨床建議請務必經由專業醫療人員判斷後使用。
                                </p>

                                <div className="flex gap-4">
                                    <a href="#" className="p-2 text-slate-400 hover:text-slate-800 hover:bg-slate-100 rounded-full transition-all">
                                        <span className="sr-only">GitHub</span>
                                        <Github size={20} />
                                    </a>
                                </div>
                            </div>
                        </div>
                    </footer>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>

